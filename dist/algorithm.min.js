/*!
 * 🔪 algorithm.js - 🔪 一些前端常用的算法实现合集。
 * git+https://github.com/hai2007/algorithm.js.git
 *
 * author hai2007 < https://hai2007.gitee.io/sweethome >
 *
 * version 0.4.0
 *
 * Copyright (c) 2020-present hai2007 走一步，再走一步。
 * Released under the MIT license
 *
 * Date:Tue Nov 24 2020 18:28:25 GMT+0800 (GMT+08:00)
 */
(function(){"use strict";function _typeof(e){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function(e){return typeof e}}else{_typeof=function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return _typeof(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _iterableToArray(e){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(e))return Array.from(e)}function _unsupportedIterableToArray(e,r){if(!e)return;if(typeof e==="string")return _arrayLikeToArray(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor)t=e.constructor.name;if(t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return _arrayLikeToArray(e,r)}function _arrayLikeToArray(e,r){if(r==null||r>e.length)r=e.length;for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function tree(e){var u=e||{},f,n;var a=function e(){var l=[],s=0,o=0;(function e(r,t){if(t>o)o=t;var n;for(n=0;n<r.children.length;n++){e(f[r.children[n]],t+1)}f[r.id].left=t+.5;if(n==0){if(l[t]==undefined)l[t]=-.5;if(l[t-1]==undefined)l[t-1]=-.5;f[r.id].top=l[t]+1;var a=l[t]+1+(f[r.pid].children.length-1)*.5;if(a-1<l[t-1])f[r.id].top=l[t-1]+1-(f[r.pid].children.length-1)*.5}else{f[r.id].top=(f[r.children[0]].top+f[r.children[n-1]].top)*.5}if(f[r.id].top<=l[t]){var i=l[t]+1-f[r.id].top;(function e(r,t){f[r].top+=i;if(l[t]<f[r].top)l[t]=f[r].top;var n;for(n=0;n<f[r].children.length;n++){e(f[r].children[n],t+1)}})(r.id,t)}l[t]=f[r.id].top;if(f[r.id].top+.5>s)s=f[r.id].top+.5})(f[n],0);return{node:f,root:n,size:s,deep:o+1}};var i=function e(i){var l={};var r=u.root(i),s,t;s=t=u.id(r);l[s]={data:r,pid:null,id:s,children:[]};var o=1;(function e(r,t){var n=u.child(r,i),a;o+=n?n.length:0;for(a=0;n&&a<n.length;a++){s=u.id(n[a]);l[t].children.push(s);l[s]={data:n[a],pid:t,id:s,children:[]};e(n[a],s)}})(r,s);return{value:[t,l],num:o}};var r=function e(r){var t=i(r);f=t.value[1];n=t.value[0];if(t.num==1){f[n].left=.5;f[n].top=.5;return{deep:1,node:f,root:n,size:1}}return a()};r.root=function(e){u.root=e;return r};r.child=function(e){u.child=e;return r};r.id=function(e){u.id=e;return r};return r}var $RegExp={blankReg:new RegExp("[\\x20\\t\\r\\n\\f]"),blanksReg:/^[\x20\t\r\n\f]{0,}$/,identifier:/^[a-zA-Z_$][0-9a-zA-Z_$]{0,}$/};var toString=Object.prototype.toString;function getType(e){if(e==null){return e===undefined?"[object Undefined]":"[object Null]"}return toString.call(e)}function _isString(e){var r=_typeof(e);return r==="string"||r==="object"&&e!=null&&!Array.isArray(e)&&getType(e)==="[object String]"}var isUndefined=function e(r){return r===undefined};var isNull=function e(r){return r===null};var isString=_isString;var isArray=function e(r){return Array.isArray(r)};function analyseTag(i){var l={},s=0;i=i.trim();var e=function e(){var r="",t="";for(;s<i.length;s++){if($RegExp.blanksReg.test(i[s])||s==i.length-1){r+=i[s];if(!$RegExp.blanksReg.test(r)){l[r.trim()]=""}s+=1;break}else if(i[s]=="="){s+=1;var n=null,a=-1;if(i.substr(s,1)=='"'||i.substr(s,1)=="'"){n=i.substr(s,1);a=1;s+=1}else if(i.substr(s,2)=='"'||i.substr(s,2)=="'"){n=i.substr(s,2);a=2;s+=2}if(n!==null){for(;s<i.length;s++){if(i.substr(s,a)==n){l[r.trim()]=t.trim();s+=2;break}else{t+=i[s]}}}else{for(;s<i.length;s++){if($RegExp.blanksReg.test(i[s])){l[r.trim()]=t.trim();s+=1;break}else{t+=i[s]}}}break}else{r+=i[s]}}if(s<i.length){e()}};e();return l}function nextTagFun(u){var f=-1,p=null;var g=false,h="";var c=["script","pre","style","code"];var d=function e(){p=f++<u.length-1?u[f]:null;return p};var y=function e(r){return u.substring(f,r+f>u.length?u.length:r+f)};d();while($RegExp.blankReg.test(p)&&f<u.length-1){d()}return function(){var e=p,r={};if(e==null)return null;if(g){r.type="textcode";r.tagName=e;while(y(h.length+3)!="</"+h+">"&&f<u.length){r.tagName+=d()}r.tagName=r.tagName.replace(/<$/,"");g=false;return r}if(y(4)=="\x3c!--"){r.type="comment";r.tagName=e;while(y(3)!="--\x3e"&&f<u.length){r.tagName+=d()}d();d();d();r.tagName=r.tagName.replace(/^<!--/,"").replace(/-$/,"");return r}if(y(9)=="<!DOCTYPE"){r.type="DOCTYPE";r.tagName=e;while(y(1)!=">"&&f<u.length){r.tagName+=d()}d();r.tagName=r.tagName.replace(/^<!DOCTYPE/,"").replace(/>$/,"");return r}else if(e=="<"){var t=false,n=null,a=null;while(t||p!=">"&&f<u.length){e+=d();if(t){var i=y(a+1).substring(1);if(i==n){t=false}}else{var l=y(2);if(l=='="'||l=="='"){n=l.replace("=","");a=1;t=true}l=y(3);if(l=='="'||l=="='"){n=l.replace("=","");a=2;t=true}}}if(/^<\//.test(e)){r.tagName=e.replace(/^<\//,"").replace(/>$/,"");r.type="endTag"}else{if(/\/>$/.test(e)){r.type="fullTag";e=e.replace(/\/>$/,"")}else{r.type="beginTag";e=e.replace(/>$/,"")}e=e.replace(/^</,"");r.tagName="";var s=0;for(;s<e.length;s++){if(e[s]==" ")break;r.tagName+=e[s]}var o=e.substring(s);if($RegExp.blanksReg.test(o)){r.attrs={}}else{r.attrs=analyseTag(o)}}}else{r.type="textcode";r.tagName=p;while(y(1)!="<"&&f<u.length){r.tagName+=d()}r.tagName=r.tagName.replace(/<$/,"");f-=1}if(r.type=="beginTag"){if(c.indexOf(r.tagName.toLowerCase())>-1){g=true;h=r.tagName}}else if(r.type=="endTag"){if(c.indexOf(r.tagName.toLowerCase())>-1){g=false}}d();return r}}function analyseDeep(e){e=closeTag(e);var r=0,t=[];e.forEach(function(e){if(e.type=="beginTag"){t.push({type:"tag",name:e.tagName,attrs:e.attrs,__deep__:++r,__tagType__:"double"})}else if(e.type=="endTag"){r-=1}else if(e.type=="textcode"){t.push({type:"text",content:e.tagName,__deep__:r+1})}else if(e.type=="comment"){t.push({type:"comment",content:e.tagName,__deep__:r+1})}else{t.push({type:"tag",name:e.tagName,attrs:e.attrs,__deep__:r+1,__tagType__:"single"})}});return t}var closeTag=function e(n){var a=[];n.forEach(function(e,r){if(e.type=="beginTag"){a.push([r,e.tagName])}else if(e.type=="endTag"){while(a.length>0){var t=a.pop();if(t[1]==e.tagName){break}else{n[t[0]].type="fullTag"}}}});return n};function xhtmlToJson(e,r){if(!isString(e))throw new Error("Template must be a String!");var t=nextTagFun(e.trim());var n=t(),a=[];while(n!=null){if(n.type=="textcode"&&$RegExp.blanksReg.test(n.tagName));else if(n.type=="DOCTYPE");else if(n.type=="comment"){if(r){a.push(n)}}else{a.push(n)}n=t()}a=analyseDeep(a);var i=[null],l=0;for(var s=0;s<a.length;s++){var o=s,u=a[s].__deep__;a[s].childNodes=[];a[s].preNode=null;a[s].nextNode=null;var f=i[i.length-1];var p=i.length>1?i[i.length-2]:null;if(u==l){a[o].preNode=f;a[f].nextNode=o;a[o].parentNode=p;a[p].childNodes.push(o);i[i.length-1]=o}else if(u>l){a[o].parentNode=f;if(f!=null)a[f].childNodes.push(o);i.push(o)}else{var g=i[i.length-1-(l-u)];var h=i[i.length-2-(l-u)];a[o].preNode=g;if(g!=null)a[g].nextNode=o;a[o].parentNode=h;if(h!=null)a[h].childNodes.push(o);for(var c=0;c<l-u;c++){i.pop()}i[i.length-1]=o}l=u}return a}function analyseExpress(e,t,r){t=t.trim();var n=-1,a=null;var i=function e(){a=n++<t.length-1?t[n]:null;return a};var l=function e(r){return t.substring(n,r+n>t.length?t.length:r+n)};i();var s=[];while(true){if(n>=t.length)break;if(["+","-","*","/","%","&","|","!","?",":","[","]","(",")",">","<","="].indexOf(a)>-1){if(["&","|","="].indexOf(a)>-1){if(["==="].indexOf(l(3))>-1){s.push(l(3));n+=2;i()}else if(["&&","||","=="].indexOf(l(2))>-1){s.push(l(2));n+=1;i()}else{throw new Error("Illegal expression : ".concat(t,"\nstep='analyseExpress',index=").concat(n))}}else{if(["!=="].indexOf(l(3))>-1){s.push(l(3));n+=2;i()}else if([">=","<=","!="].indexOf(l(2))>-1){s.push(l(2));n+=1;i()}else{s.push(a);i()}}}else if(['"',"'"].indexOf(a)>-1){var o="",u=a;i();while(a!=u){if(n>=t.length){throw new Error("String unclosed error : ".concat(t,"\nstep='analyseExpress',index=").concat(n))}o+=a;i()}s.push(o+"@string");i()}else if(/\d/.test(a)){var f="no";var p=a;i();while(n<t.length){if(/\d/.test(a)){p+=a;if(f=="error")f="yes"}else if("."==a&&f=="no"){p+=a;f="error"}else{break}i()}if(f=="error")p+="0";s.push(+p)}else if(["null","true"].indexOf(l(4))>-1){s.push({null:null,true:true}[l(4)]);n+=3;i()}else if(["false"].indexOf(l(5))>-1){s.push({false:false}[l(5)]);n+=4;i()}else if(["undefined"].indexOf(l(9))>-1){s.push({undefined:undefined}[l(9)]);n+=8;i()}else if($RegExp.blankReg.test(a)){do{i()}while($RegExp.blankReg.test(a)&&n<t.length)}else{var g=false;if(a=="."){g=true;i()}if($RegExp.identifier.test(a)){var h=1;while(n+h<=t.length&&$RegExp.identifier.test(l(h))){h+=1}if(g){s.push("[");s.push(l(h-1)+"@string");s.push("]")}else{var c=l(h-1);var d=c in r?r[c]:e[c];s.push(isString(d)?d+"@string":d)}n+=h-2;i()}else{throw new Error("Illegal express : ".concat(t,"\nstep='analyseExpress',index=").concat(n))}}}return s}var getExpressValue=function e(r){if(typeof r=="string")return r.replace(/@string$/,"");return r};function evalValue(expressArray){var express="";for(var _i=0;_i<expressArray.length;_i++){if(isString(expressArray[_i])&&/@string$/.test(expressArray[_i]))express+=JSON.stringify(expressArray[_i].replace(/@string$/,""));else if(isNull(expressArray[_i]))express+="null";else if(isUndefined(expressArray[_i]))express+="undefined";else express+=expressArray[_i]}console.log(JSON.stringify(expressArray));var length=0,i=0;for(;i<expressArray.length;i++){if(expressArray[i]=="!"){expressArray[length]=!expressArray[++i]}length+=1}if(length==1)return getExpressValue(expressArray[0]);expressArray.length=length;length=0;for(i=0;i<expressArray.length;i++){if(expressArray[i]=="*"){expressArray[length-1]=getExpressValue(expressArray[i-1])*getExpressValue(expressArray[++i])}else if(expressArray[i]=="/"){expressArray[length-1]=getExpressValue(expressArray[i-1])/getExpressValue(expressArray[++i])}else if(expressArray[i]=="%"){expressArray[length-1]=getExpressValue(expressArray[i-1])%getExpressValue(expressArray[++i])}else length+=1}if(length==1)return getExpressValue(expressArray[0]);expressArray.length=length;console.error(expressArray);return eval(express)}function calcValue(r,t,n){var e=t[0]in n?n[t[0]]:r[t[0]];for(var a=1;a<t.length;a++){try{e=e[t[a]]}catch(e){console.error({target:r,scope:n,expressArray:t,index:a});throw e}}return e}var doit1=function e(r,t,n){if(t.indexOf("(")>-1){var a=[],i=[],l=0;for(var s=0;s<t.length;s++){if(t[s]=="("){if(l>0){i.push("(")}l+=1}else if(t[s]==")"){if(l>1)i.push(")");l-=1;if(l==0){var o=evalValue(e(r,i));a.push(isString(o)?o+"@string":o);i=[]}}else{if(l>0)i.push(t[s]);else a.push(t[s])}}t=a}return doit2(t)};var doit2=function e(r){var t=true;while(t){t=false;var n=[],a=[],i=false;for(var l=0;l<r.length;l++){if(r[l]=="["&&l!=0&&r[l-1]!="]"){if(i){n.push("[");for(var s=0;s<a.length;s++){n.push(a[s])}a=[]}else{i=true}}else if(r[l]=="]"&&i){t=true;var o=evalValue(a);var u=n[n.length-1][o];n[n.length-1]=isString(u)?u+"@string":u;i=false}else{if(i){a.push(r[l])}else{n.push(r[l])}}}r=n}return r};var doit3=function e(r){var t=[],n=[];for(var a=0;a<r.length;a++){if(r[a]=="["){n=[]}else if(r[a]=="]"){t.push(evalValue(n))}else{n.push(r[a])}}return t};function toPath(e,r,t){var n=doit1(e,r);var a;if(n[0]!="["){a=[evalValue(n)]}else if(n[n.length-1]=="]"){a=doit3(n)}else{var i=n.lastIndexOf("]");var l=doit3(n.slice(0,i+1));a=[evalValue([calcValue(e,l,t)].concat(_toConsumableArray(n.slice(i+1))))]}return a}var evalExpress=function e(r,t){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var a=analyseExpress(r,t,n);var i=toPath(r,a,n);if(i.length>1)throw new Error("Illegal expression : ".concat(t,"\nstep='evalExpress',path=").concat(i,",expressArray=").concat(a));return i[0]};var getValue=function e(r,t){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var a=analyseExpress(r,t,n);var i=toPath(r,a,n);return calcValue(r,i,n)};var setValue=function e(r,t,n){var a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var i=analyseExpress(r,t,a);var l=toPath(r,i,a);var s=r;for(var o=0;o<l.length-1;o++){if(!(l[o]in s))s[l[o]]=isArray(s)?[]:{};s=s[l[o]]}s[l[l.length-1]]=n;return r};var algorithm={tree:tree,xhtmlToJson:xhtmlToJson,evalExpress:evalExpress,getValue:getValue,setValue:setValue};if((typeof module==="undefined"?"undefined":_typeof(module))==="object"&&_typeof(module.exports)==="object"){module.exports=algorithm}else{window.algorithm=algorithm}})();